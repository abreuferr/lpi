#: Title : LDAP client usage
#: Author : "Caio Abreu Ferreira" <abreuferr_gmail.com>
#: Description : LDAP client usage
#: Options : Weight: 2

Description: Candidates should be able to perform queries 
and updates to an LDAP server. Also included is importing 
and adding items, as well as adding and managing users.

Key Knowledge Areas:

LDAP utilities for data management and queries
Change user passwords
Querying the LDAP directory
Terms and Utilities:

ldapsearch
ldappasswd
ldapadd
ldapdelete

#
# TEORIA
#

dc=particula,dc=local
cn=admin,dc=particula,dc=local

ou=users,dc=particula,dc=local
uid=cosmo,ou=users,dc=particula,dc=local

ou=groups,dc=particula,dc=local
cn=department,ou=groups,dc=particula,dc=local

#
# INSTALACAO
#

# atualizacao do debian
$ sudo apt-get update && sudo apt-get upgrade

# instalacao cliente ldap
$ sudo apt-get install libnss-ldap libpam-ldapnscd ldap-utils ldapscripts -y -d

#
# CONFIGURACAO
#

# backup do arquivo de configuracao
$ sudo cp /etc/ldap/ldap.conf{,.origin}

# configuracao inicial do cliente ldap.
$ sudo vi /etc/ldap/ldap.conf
	BASE    dc=particula,dc=local
	URI     ldap://openldap.particula.local ldap://openldap.particula.local:666

# todos os arquivos ldif estao presentes na url 
# https://github.com/abreuferr/lpi/tree/master/202/src

#
# OU
#

# adicionar
$ sudo ldapadd -x -W -D "cn=admin,dc=particula,dc=local" -f add_ou.ldif
# renomear
$ ???
# apagar
$ sudo ldapmodify  -x -W -D "cn=admin,dc=particula,dc=local" -f del_ou.ldif

#
# GRUPO
#

# adicionar
$ sudo ldapadd -x -W -D "cn=admin,dc=particula,dc=local" -f add_group.ldif
# renomear
$ ???
# apagar
$ sudo ldapmodify  -x -W -D "cn=admin,dc=particula,dc=local" -f del_group.ldif

#
# USUARIO
#

# adicionar
$ sudo ldapadd -x -W -D "cn=admin,dc=particula,dc=local" -f add_user.ldif
# renomear
$ ???
# apagar
$ sudo ldapmodify  -x -W -D "cn=admin,dc=particula,dc=local" -f del_user.ldif

#
# USUARIO + GRUPO
#

# adicionar
$ sudo ldapadd -x -W -D "cn=admin,dc=particula,dc=local" -f add_user_to_group.ldif
# renomear
$ ???
# apagar
$ sudo ldapmodify  -x -W -D "cn=admin,dc=particula,dc=local" -f del_user_to_group.ldif


# LDAPSEARCH
#

# busca por um UID
$ sudo ldapsearch -x -W "(uid=cosmo)"

#
# LDAPPASSWD
#

# alterar a senha do usuario.
$ ldappasswd -x -W -S uid=cosmo,ou=people,dc=particula,dc=local
