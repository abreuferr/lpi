#: Title : Securing FTP servers
#: Author : "Caio Abreu Ferreira" <abreuferr_gmail.com>
#: Description : Securing FTP servers
#: Options : Weight: 2

Description: Candidates should be able to configure 
an FTP server for anonymous downloads and uploads. 
This objective includes precautions to be taken if 
anonymous uploads are permitted and configuring user 
access.

Key Knowledge Areas:
- Configuration files, tools and utilities for Pure-FTPd and vsftpd
- Awareness of ProFTPd
- Understanding of passive vs. active FTP connections

Terms and Utilities:
- vsftpd.conf
- important Pure-FTPd command line options

#
# VSFTPD - INSTALACAO
#

# atualizacao do gnu/linux debian.
$ sudo apt-get update
$ sudo apt-get upgrade

# instalacao do vsftpd.
$ sudo apt-get install vsftpd -y -d

#
# CONFIGURACAO
#

# copia de seguranca.
$ sudo cp /etc/vsftpd.conf /etc/vsftpd.conf.BKP

# editando o arquivo de configuracao.
$ sudo vi /etc/vsftpd.conf
	# ativando ou nao o usuario anonymous.
	anonymous_enable=NO/YES
	# permite ou nao que usuario anonymous possa
	# fazer o upload de arquivos.
	anon_upload_enable=YES/NO
	# permite ou nao que usuario anonymous possa
	# criar diretorio.
	anon_mkdir_write_enable=YES/NO

	# ativar ou nao a utilizacao de usuario local.
	local_enable=YES/NO
	# permitir ou nao que usuario possa fazer o upload
	# de arquivos.
	write_enable=YES/NO

	# define quais usuarios podem fazer o logon
	# no servidor ftp
	userlist_enable=YES
	# lista com os usuarios que podem fazer login
	# no servidor ftp
	userlist_file=/etc/vsftpd.user_list

	# ativando ou nao a opcao de chroot.
	chroot_local_user=YES/NO
	# lista de usuarios que farao ou nao chroot.
	chroot_list_file=/etc/vsftpd.chroot_list
	# permite que usuario com chroot possa fazer upload
	# de arquivos.
	allow_writeable_chroot=YES

	# ativando a opcao de SSL no vsftpd.
	rsa_cert_file=/etc/ssl/private/vsftpd.pem
	rsa_private_key_file=/etc/ssl/private/vsftpd.pem
	ssl_enable=YES

# criando certificado SSL
$ sudo sudo openssl req -x509 -nodes -days 3650 -newkey rsa:2048 -keyout /etc/ssl/private/vsftpd.pem -out /etc/ssl/private/vsftpd.pem

# reinicializando o vsftpd
$ sudo systemctl restart vsftpd.service
