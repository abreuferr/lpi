#: Title : DNS Cache
#: Author : "Caio Abreu Ferreira" <abreuferr_gmail.com>
#: Description : Configuracao do Bind9 como DNS Cache
#: Options : None

# INSTALACAO
#
$ sudo apt-get install bind9 dnsutils bind9 bind9utils bind9-doc -y -d ; instalacao
$ sudo chown -R bind:bind /etc/bind ; alterando permissao
$ sudo systemctl restart bind9.service ; reinicializando o bind

# CONFIGURACAO
#
$ sudo vi /etc/bind/named.conf.options
    include "/etc/bind/rndc.key";

    controls {
            inet 127.0.0.1 port 953
            allow { 127.0.0.1; } keys { "rndc-key"; };
    };

    acl "clients" {
            192.168.0.0/24;
            localhost;
            localhost;
    };

    options {
            directory "/var/cache/bind";

            recursion yes;
            allow-query { clients; };

            forwarders {
                192.168.0.5;
                192.168.0.6;
            };
            forward only;

            dnssec-enable yes;
            dnssec-validation auto;
    };

$ sudo named-checkconf /etc/bind/named.conf ; checando os arquivos de configuracao
$ sudo systemctl restart bind9.service ; reinicializando o servico do bind9

$ sudo vi /etc/resolv.conf ; de todas as estacoes da rede
    domain particula.local
    search particula.local
    nameserver 192.168.0.4

# TESTE (DNSCACHE)
#
$ sudo netstat -nltup | grep :53
$ dig kernel.org | grep time ; checar o tempo de resposta do dig

# TESTE (ESTACAO)
#
$ dig kernel.org | grep time ; checar o tempo de resposta do dig
